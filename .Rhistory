best.var <- names(which(summary_best_subset$which[314,]==TRUE))
best.form <- paste("y~", paste(best.var, collapse = "+"))
best.form
best.model <- lm(best.form, data = compare)
best.form <- paste("y~", paste(best.var, collapse = "+"))
best.form
best.form <- as.formula("y~ (Intercept)+age+bleed_sys+pelvicpain+anxiety+qltottr+qlcerntr+qlcnsctr+qlergytr+severtr+utervol+gyn_his+route+agegrp+t+severgrp2+tsdiag+uvgrp+race_ps:agegrp+race_ps:t+private:agegrp+priorproc:agegrp+priorproc:t+bleed_sys:agegrp+bleed_sys:t+pelvicpain:agegrp+anxiety:t+qlactvtr:agegrp+qlactvtr:t+qlcerntr:t+qlctrltr:agegrp+qlergytr:t+qlsexftr:agegrp+qlsexftr:t+severtr:agegrp+cfhsscalehealth:agegrp+timehdfibsys_yrs:agegrp+utervol:agegrp+race_ps:bleed_sys+race_ps:pelvicpain+race_ps:qlsexftr+race_ps:severtr+race_ps:timehdfibsys_yrs+age:priorproc+private:priorproc+nchildren_cat:priorproc+priorproc:pelvicpain+priorproc:anxiety+priorproc:qlcnsctr+priorproc:qlctrltr+priorproc:qlergytr+priorproc:cfhsscalehealth+private:nchildren_cat+nchildren_cat:bleed_sys+nchildren_cat:pelvicpain+nchildren_cat:qlcerntr+nchildren_cat:qlcnsctr+nchildren_cat:cfhsscalehealth+nchildren_cat:timehdfibsys_yrs+nchildren_cat:utervol+age:anxiety+private:anxiety+bleed_sys:anxiety+pelvicpain:anxiety+anxiety:qlactvtr+anxiety:qlcerntr+anxiety:qlergytr+anxiety:qlsexftr+anxiety:severtr+anxiety:timehdfibsys_yrs+anxiety:utervol+private:bleed_sys+bleed_sys:qlactvtr+bleed_sys:qlcerntr+bleed_sys:severtr+demhisp_new:pelvicpain+private:pelvicpain+pelvicpain:qlactvtr+pelvicpain:qlctrltr+pelvicpain:qlergytr+pelvicpain:utervol+age:qolgrp+t:qolgrp+demhisp_new:qolgrp+private:qolgrp+nchildren_cat:qolgrp+priorproc:qolgrp+bleed_sys:qolgrp+pelvicpain:qolgrp+anxiety:qolgrp+qlcerntr:qolgrp+qlergytr:qolgrp+qlsexftr:qolgrp+severtr:qolgrp+timehdfibsys_yrs:qolgrp+utervol:qolgrp+private:severgrp2+pelvicpain:severgrp2+qlactvtr:severgrp2+qlcerntr:severgrp2+qlcnsctr:severgrp2+qlergytr:severgrp2+cfhsscalehealth:severgrp2+age:vas70+demhisp_new:vas70+private:vas70+pelvicpain:vas70+qlactvtr:vas70+qlcerntr:vas70+qlcnsctr:vas70+qlctrltr:vas70+qlergytr:vas70+qlsexftr:vas70+timehdfibsys_yrs:vas70+utervol:vas70+t:tsdiag+demhisp_new:tsdiag+priorproc:tsdiag+bleed_sys:tsdiag+pelvicpain:tsdiag+anxiety:tsdiag+qlergytr:tsdiag+age:uvgrp+race_ps:uvgrp+demhisp_new:uvgrp+private:uvgrp+nchildren_cat:uvgrp+qlactvtr:uvgrp+qlctrltr:uvgrp+qlergytr:uvgrp+qlsexftr:uvgrp+timehdfibsys_yrs:uvgrp+utervol:uvgrp+age:obesity+demhisp_new:obesity+private:obesity+qlactvtr:obesity+qlcerntr:obesity+qlctrltr:obesity+qlsexftr:obesity+severtr:obesity+utervol:obesity+age:gyn_his+gyn_his:t+demhisp_new:gyn_his+private:gyn_his+bleed_sys:gyn_his+anxiety:gyn_his+qlcnsctr:gyn_his+severtr:gyn_his+timehdfibsys_yrs:gyn_his+age:fintox+race_ps:fintox+demhisp_new:fintox+private:fintox+nchildren_cat:fintox+priorproc:fintox+anxiety:fintox+qlergytr:fintox+qlsexftr:fintox+utervol:fintox+age:route+demhisp_new:route+priorproc:route+bleed_sys:route+pelvicpain:route+qlcnsctr:route+qlergytr:route+cfhsscalehealth:route+timehdfibsys_yrs:route+utervol:route+age:agegrp:t+private:agegrp:t+priorproc:agegrp:t+bleed_sys:agegrp:t+pelvicpain:agegrp:t+qlactvtr:agegrp:t+qlcnsctr:agegrp:t+severtr:agegrp:t+timehdfibsys_yrs:agegrp:t+utervol:agegrp:t+race_ps:bleed_sys:t+race_ps:pelvicpain:t+race_ps:qlcnsctr:t+race_ps:severtr:t+race_ps:cfhsscalehealth:t+race_ps:timehdfibsys_yrs:t+age:priorproc:t+nchildren_cat:priorproc:t+priorproc:pelvicpain:t+priorproc:qlactvtr:t+priorproc:qlcnsctr:t+priorproc:qlctrltr:t+priorproc:qlergytr:t+priorproc:cfhsscalehealth:t+priorproc:timehdfibsys_yrs:t+private:nchildren_cat:t+nchildren_cat:bleed_sys:t+nchildren_cat:pelvicpain:t+nchildren_cat:qlcerntr:t+nchildren_cat:qlcnsctr:t+nchildren_cat:qlergytr:t+nchildren_cat:cfhsscalehealth:t+nchildren_cat:timehdfibsys_yrs:t+private:anxiety:t+bleed_sys:anxiety:t+pelvicpain:anxiety:t+anxiety:qlactvtr:t+anxiety:qlctrltr:t+anxiety:qlergytr:t+anxiety:qlsexftr:t+anxiety:severtr:t+anxiety:cfhsscalehealth:t+anxiety:timehdfibsys_yrs:t+anxiety:utervol:t+demhisp_new:bleed_sys:t+private:bleed_sys:t+bleed_sys:qlactvtr:t+bleed_sys:qlcerntr:t+bleed_sys:severtr:t+pelvicpain:qlactvtr:t+pelvicpain:qlcerntr:t+pelvicpain:qlcnsctr:t+pelvicpain:qlergytr:t+pelvicpain:utervol:t+age:t:qolgrp+demhisp_new:t:qolgrp+private:t:qolgrp+nchildren_cat:t:qolgrp+pelvicpain:t:qolgrp+anxiety:t:qolgrp+qlcerntr:t:qolgrp+qlctrltr:t:qolgrp+qlergytr:t:qolgrp+qlsexftr:t:qolgrp+cfhsscalehealth:t:qolgrp+timehdfibsys_yrs:t:qolgrp+utervol:t:qolgrp+demhisp_new:t:severgrp2+private:t:severgrp2+priorproc:t:severgrp2+pelvicpain:t:severgrp2+qlactvtr:t:severgrp2+qlcerntr:t:severgrp2+qlcnsctr:t:severgrp2+qlctrltr:t:severgrp2+qlergytr:t:severgrp2+utervol:t:severgrp2+demhisp_new:t:vas70+private:t:vas70+nchildren_cat:t:vas70+bleed_sys:t:vas70+qlactvtr:t:vas70+qlcnsctr:t:vas70+qlctrltr:t:vas70+qlergytr:t:vas70+qlsexftr:t:vas70+cfhsscalehealth:t:vas70+timehdfibsys_yrs:t:vas70+utervol:t:vas70+age:t:tsdiag+race_ps:t:tsdiag+priorproc:t:tsdiag+bleed_sys:t:tsdiag+anxiety:t:tsdiag+qlactvtr:t:tsdiag+qlctrltr:t:tsdiag+qlergytr:t:tsdiag+age:t:uvgrp+race_ps:t:uvgrp+nchildren_cat:t:uvgrp+anxiety:t:uvgrp+qlactvtr:t:uvgrp+qlctrltr:t:uvgrp+qlergytr:t:uvgrp+severtr:t:uvgrp+cfhsscalehealth:t:uvgrp+timehdfibsys_yrs:t:uvgrp+age:obesity:t+race_ps:obesity:t+demhisp_new:obesity:t+private:obesity:t+qlcerntr:obesity:t+qlctrltr:obesity:t+qlsexftr:obesity:t+severtr:obesity:t+cfhsscalehealth:obesity:t+utervol:obesity:t+private:gyn_his:t+bleed_sys:gyn_his:t+pelvicpain:gyn_his:t+anxiety:gyn_his:t+qlactvtr:gyn_his:t+qlcnsctr:gyn_his:t+qlsexftr:gyn_his:t+severtr:gyn_his:t+timehdfibsys_yrs:gyn_his:t+race_ps:fintox:t+nchildren_cat:fintox:t+priorproc:fintox:t+anxiety:fintox:t+qlcerntr:fintox:t+qlergytr:fintox:t+qlsexftr:fintox:t+severtr:fintox:t+nchildren_cat:route:t+priorproc:route:t+bleed_sys:route:t+anxiety:route:t+qlactvtr:route:t+qlcerntr:route:t+qlctrltr:route:t+qlergytr:route:t+qlsexftr:route:t+cfhsscalehealth:route:t")
best.form <- as.formula("y~ (Intercept)+age+bleed_sys+pelvicpain+anxiety+qltottr+qlcerntr+qlcnsctr+qlergytr+severtr+utervol+gyn_his+route+agegrp+t+severgrp2+tsdiag+uvgrp+race_ps:agegrp+race_ps:t+private:agegrp+priorproc:agegrp+priorproc:t+bleed_sys:agegrp+bleed_sys:t+pelvicpain:agegrp+anxiety:t+qlactvtr:agegrp+qlactvtr:t+qlcerntr:t+qlctrltr:agegrp+qlergytr:t+qlsexftr:agegrp+qlsexftr:t+severtr:agegrp+cfhsscalehealth:agegrp+timehdfibsys_yrs:agegrp+utervol:agegrp+race_ps:bleed_sys+race_ps:pelvicpain+race_ps:qlsexftr+race_ps:severtr+race_ps:timehdfibsys_yrs+age:priorproc+private:priorproc+nchildren_cat:priorproc+priorproc:pelvicpain+priorproc:anxiety+priorproc:qlcnsctr+priorproc:qlctrltr+priorproc:qlergytr+priorproc:cfhsscalehealth+private:nchildren_cat+nchildren_cat:bleed_sys+nchildren_cat:pelvicpain+nchildren_cat:qlcerntr+nchildren_cat:qlcnsctr+nchildren_cat:cfhsscalehealth+nchildren_cat:timehdfibsys_yrs+nchildren_cat:utervol+age:anxiety+private:anxiety+bleed_sys:anxiety+pelvicpain:anxiety+anxiety:qlactvtr+anxiety:qlcerntr+anxiety:qlergytr+anxiety:qlsexftr+anxiety:severtr+anxiety:timehdfibsys_yrs+anxiety:utervol+private:bleed_sys+bleed_sys:qlactvtr+bleed_sys:qlcerntr+bleed_sys:severtr+demhisp_new:pelvicpain+private:pelvicpain+pelvicpain:qlactvtr+pelvicpain:qlctrltr+pelvicpain:qlergytr+pelvicpain:utervol+age:qolgrp+t:qolgrp+demhisp_new:qolgrp+private:qolgrp+nchildren_cat:qolgrp+priorproc:qolgrp+bleed_sys:qolgrp+pelvicpain:qolgrp+anxiety:qolgrp+qlcerntr:qolgrp+qlergytr:qolgrp+qlsexftr:qolgrp+severtr:qolgrp+timehdfibsys_yrs:qolgrp+utervol:qolgrp+private:severgrp2+pelvicpain:severgrp2+qlactvtr:severgrp2+qlcerntr:severgrp2+qlcnsctr:severgrp2+qlergytr:severgrp2+cfhsscalehealth:severgrp2+age:vas70+demhisp_new:vas70+private:vas70+pelvicpain:vas70+qlactvtr:vas70+qlcerntr:vas70+qlcnsctr:vas70+qlctrltr:vas70+qlergytr:vas70+qlsexftr:vas70+timehdfibsys_yrs:vas70+utervol:vas70+t:tsdiag+demhisp_new:tsdiag+priorproc:tsdiag+bleed_sys:tsdiag+pelvicpain:tsdiag+anxiety:tsdiag+qlergytr:tsdiag+age:uvgrp+race_ps:uvgrp+demhisp_new:uvgrp+private:uvgrp+nchildren_cat:uvgrp+qlactvtr:uvgrp+qlctrltr:uvgrp+qlergytr:uvgrp+qlsexftr:uvgrp+timehdfibsys_yrs:uvgrp+utervol:uvgrp+age:obesity+demhisp_new:obesity+private:obesity+qlactvtr:obesity+qlcerntr:obesity+qlctrltr:obesity+qlsexftr:obesity+severtr:obesity+utervol:obesity+age:gyn_his+gyn_his:t+demhisp_new:gyn_his+private:gyn_his+bleed_sys:gyn_his+anxiety:gyn_his+qlcnsctr:gyn_his+severtr:gyn_his+timehdfibsys_yrs:gyn_his+age:fintox+race_ps:fintox+demhisp_new:fintox+private:fintox+nchildren_cat:fintox+priorproc:fintox+anxiety:fintox+qlergytr:fintox+qlsexftr:fintox+utervol:fintox+age:route+demhisp_new:route+priorproc:route+bleed_sys:route+pelvicpain:route+qlcnsctr:route+qlergytr:route+cfhsscalehealth:route+timehdfibsys_yrs:route+utervol:route+age:agegrp:t+private:agegrp:t+priorproc:agegrp:t+bleed_sys:agegrp:t+pelvicpain:agegrp:t+qlactvtr:agegrp:t+qlcnsctr:agegrp:t+severtr:agegrp:t+timehdfibsys_yrs:agegrp:t+utervol:agegrp:t+race_ps:bleed_sys:t+race_ps:pelvicpain:t+race_ps:qlcnsctr:t+race_ps:severtr:t+race_ps:cfhsscalehealth:t+race_ps:timehdfibsys_yrs:t+age:priorproc:t+nchildren_cat:priorproc:t+priorproc:pelvicpain:t+priorproc:qlactvtr:t+priorproc:qlcnsctr:t+priorproc:qlctrltr:t+priorproc:qlergytr:t+priorproc:cfhsscalehealth:t+priorproc:timehdfibsys_yrs:t+private:nchildren_cat:t+nchildren_cat:bleed_sys:t+nchildren_cat:pelvicpain:t+nchildren_cat:qlcerntr:t+nchildren_cat:qlcnsctr:t+nchildren_cat:qlergytr:t+nchildren_cat:cfhsscalehealth:t+nchildren_cat:timehdfibsys_yrs:t+private:anxiety:t+bleed_sys:anxiety:t+pelvicpain:anxiety:t+anxiety:qlactvtr:t+anxiety:qlctrltr:t+anxiety:qlergytr:t+anxiety:qlsexftr:t+anxiety:severtr:t+anxiety:cfhsscalehealth:t+anxiety:timehdfibsys_yrs:t+anxiety:utervol:t+demhisp_new:bleed_sys:t+private:bleed_sys:t+bleed_sys:qlactvtr:t+bleed_sys:qlcerntr:t+bleed_sys:severtr:t+pelvicpain:qlactvtr:t+pelvicpain:qlcerntr:t+pelvicpain:qlcnsctr:t+pelvicpain:qlergytr:t+pelvicpain:utervol:t+age:t:qolgrp+demhisp_new:t:qolgrp+private:t:qolgrp+nchildren_cat:t:qolgrp+pelvicpain:t:qolgrp+anxiety:t:qolgrp+qlcerntr:t:qolgrp+qlctrltr:t:qolgrp+qlergytr:t:qolgrp+qlsexftr:t:qolgrp+cfhsscalehealth:t:qolgrp+timehdfibsys_yrs:t:qolgrp+utervol:t:qolgrp+demhisp_new:t:severgrp2+private:t:severgrp2+priorproc:t:severgrp2+pelvicpain:t:severgrp2+qlactvtr:t:severgrp2+qlcerntr:t:severgrp2+qlcnsctr:t:severgrp2+qlctrltr:t:severgrp2+qlergytr:t:severgrp2+utervol:t:severgrp2+demhisp_new:t:vas70+private:t:vas70+nchildren_cat:t:vas70+bleed_sys:t:vas70+qlactvtr:t:vas70+qlcnsctr:t:vas70+qlctrltr:t:vas70+qlergytr:t:vas70+qlsexftr:t:vas70+cfhsscalehealth:t:vas70+timehdfibsys_yrs:t:vas70+utervol:t:vas70+age:t:tsdiag+race_ps:t:tsdiag+priorproc:t:tsdiag+bleed_sys:t:tsdiag+anxiety:t:tsdiag+qlactvtr:t:tsdiag+qlctrltr:t:tsdiag+qlergytr:t:tsdiag+age:t:uvgrp+race_ps:t:uvgrp+nchildren_cat:t:uvgrp+anxiety:t:uvgrp+qlactvtr:t:uvgrp+qlctrltr:t:uvgrp+qlergytr:t:uvgrp+severtr:t:uvgrp+cfhsscalehealth:t:uvgrp+timehdfibsys_yrs:t:uvgrp+age:obesity:t+race_ps:obesity:t+demhisp_new:obesity:t+private:obesity:t+qlcerntr:obesity:t+qlctrltr:obesity:t+qlsexftr:obesity:t+severtr:obesity:t+cfhsscalehealth:obesity:t+utervol:obesity:t+private:gyn_his:t+bleed_sys:gyn_his:t+pelvicpain:gyn_his:t+anxiety:gyn_his:t+qlactvtr:gyn_his:t+qlcnsctr:gyn_his:t+qlsexftr:gyn_his:t+severtr:gyn_his:t+timehdfibsys_yrs:gyn_his:t+race_ps:fintox:t+nchildren_cat:fintox:t+priorproc:fintox:t+anxiety:fintox:t+qlcerntr:fintox:t+qlergytr:fintox:t+qlsexftr:fintox:t+severtr:fintox:t+nchildren_cat:route:t+priorproc:route:t+bleed_sys:route:t+anxiety:route:t+qlactvtr:route:t+qlcerntr:route:t+qlctrltr:route:t+qlergytr:route:t+qlsexftr:route:t+cfhsscalehealth:route:t")
best.form
best.form <- as.formula("y~ age+bleed_sys+pelvicpain+anxiety+qltottr+qlcerntr+qlcnsctr+qlergytr+severtr+utervol+gyn_his+route+agegrp+t+severgrp2+tsdiag+uvgrp+race_ps:agegrp+race_ps:t+private:agegrp+priorproc:agegrp+priorproc:t+bleed_sys:agegrp+bleed_sys:t+pelvicpain:agegrp+anxiety:t+qlactvtr:agegrp+qlactvtr:t+qlcerntr:t+qlctrltr:agegrp+qlergytr:t+qlsexftr:agegrp+qlsexftr:t+severtr:agegrp+cfhsscalehealth:agegrp+timehdfibsys_yrs:agegrp+utervol:agegrp+race_ps:bleed_sys+race_ps:pelvicpain+race_ps:qlsexftr+race_ps:severtr+race_ps:timehdfibsys_yrs+age:priorproc+private:priorproc+nchildren_cat:priorproc+priorproc:pelvicpain+priorproc:anxiety+priorproc:qlcnsctr+priorproc:qlctrltr+priorproc:qlergytr+priorproc:cfhsscalehealth+private:nchildren_cat+nchildren_cat:bleed_sys+nchildren_cat:pelvicpain+nchildren_cat:qlcerntr+nchildren_cat:qlcnsctr+nchildren_cat:cfhsscalehealth+nchildren_cat:timehdfibsys_yrs+nchildren_cat:utervol+age:anxiety+private:anxiety+bleed_sys:anxiety+pelvicpain:anxiety+anxiety:qlactvtr+anxiety:qlcerntr+anxiety:qlergytr+anxiety:qlsexftr+anxiety:severtr+anxiety:timehdfibsys_yrs+anxiety:utervol+private:bleed_sys+bleed_sys:qlactvtr+bleed_sys:qlcerntr+bleed_sys:severtr+demhisp_new:pelvicpain+private:pelvicpain+pelvicpain:qlactvtr+pelvicpain:qlctrltr+pelvicpain:qlergytr+pelvicpain:utervol+age:qolgrp+t:qolgrp+demhisp_new:qolgrp+private:qolgrp+nchildren_cat:qolgrp+priorproc:qolgrp+bleed_sys:qolgrp+pelvicpain:qolgrp+anxiety:qolgrp+qlcerntr:qolgrp+qlergytr:qolgrp+qlsexftr:qolgrp+severtr:qolgrp+timehdfibsys_yrs:qolgrp+utervol:qolgrp+private:severgrp2+pelvicpain:severgrp2+qlactvtr:severgrp2+qlcerntr:severgrp2+qlcnsctr:severgrp2+qlergytr:severgrp2+cfhsscalehealth:severgrp2+age:vas70+demhisp_new:vas70+private:vas70+pelvicpain:vas70+qlactvtr:vas70+qlcerntr:vas70+qlcnsctr:vas70+qlctrltr:vas70+qlergytr:vas70+qlsexftr:vas70+timehdfibsys_yrs:vas70+utervol:vas70+t:tsdiag+demhisp_new:tsdiag+priorproc:tsdiag+bleed_sys:tsdiag+pelvicpain:tsdiag+anxiety:tsdiag+qlergytr:tsdiag+age:uvgrp+race_ps:uvgrp+demhisp_new:uvgrp+private:uvgrp+nchildren_cat:uvgrp+qlactvtr:uvgrp+qlctrltr:uvgrp+qlergytr:uvgrp+qlsexftr:uvgrp+timehdfibsys_yrs:uvgrp+utervol:uvgrp+age:obesity+demhisp_new:obesity+private:obesity+qlactvtr:obesity+qlcerntr:obesity+qlctrltr:obesity+qlsexftr:obesity+severtr:obesity+utervol:obesity+age:gyn_his+gyn_his:t+demhisp_new:gyn_his+private:gyn_his+bleed_sys:gyn_his+anxiety:gyn_his+qlcnsctr:gyn_his+severtr:gyn_his+timehdfibsys_yrs:gyn_his+age:fintox+race_ps:fintox+demhisp_new:fintox+private:fintox+nchildren_cat:fintox+priorproc:fintox+anxiety:fintox+qlergytr:fintox+qlsexftr:fintox+utervol:fintox+age:route+demhisp_new:route+priorproc:route+bleed_sys:route+pelvicpain:route+qlcnsctr:route+qlergytr:route+cfhsscalehealth:route+timehdfibsys_yrs:route+utervol:route+age:agegrp:t+private:agegrp:t+priorproc:agegrp:t+bleed_sys:agegrp:t+pelvicpain:agegrp:t+qlactvtr:agegrp:t+qlcnsctr:agegrp:t+severtr:agegrp:t+timehdfibsys_yrs:agegrp:t+utervol:agegrp:t+race_ps:bleed_sys:t+race_ps:pelvicpain:t+race_ps:qlcnsctr:t+race_ps:severtr:t+race_ps:cfhsscalehealth:t+race_ps:timehdfibsys_yrs:t+age:priorproc:t+nchildren_cat:priorproc:t+priorproc:pelvicpain:t+priorproc:qlactvtr:t+priorproc:qlcnsctr:t+priorproc:qlctrltr:t+priorproc:qlergytr:t+priorproc:cfhsscalehealth:t+priorproc:timehdfibsys_yrs:t+private:nchildren_cat:t+nchildren_cat:bleed_sys:t+nchildren_cat:pelvicpain:t+nchildren_cat:qlcerntr:t+nchildren_cat:qlcnsctr:t+nchildren_cat:qlergytr:t+nchildren_cat:cfhsscalehealth:t+nchildren_cat:timehdfibsys_yrs:t+private:anxiety:t+bleed_sys:anxiety:t+pelvicpain:anxiety:t+anxiety:qlactvtr:t+anxiety:qlctrltr:t+anxiety:qlergytr:t+anxiety:qlsexftr:t+anxiety:severtr:t+anxiety:cfhsscalehealth:t+anxiety:timehdfibsys_yrs:t+anxiety:utervol:t+demhisp_new:bleed_sys:t+private:bleed_sys:t+bleed_sys:qlactvtr:t+bleed_sys:qlcerntr:t+bleed_sys:severtr:t+pelvicpain:qlactvtr:t+pelvicpain:qlcerntr:t+pelvicpain:qlcnsctr:t+pelvicpain:qlergytr:t+pelvicpain:utervol:t+age:t:qolgrp+demhisp_new:t:qolgrp+private:t:qolgrp+nchildren_cat:t:qolgrp+pelvicpain:t:qolgrp+anxiety:t:qolgrp+qlcerntr:t:qolgrp+qlctrltr:t:qolgrp+qlergytr:t:qolgrp+qlsexftr:t:qolgrp+cfhsscalehealth:t:qolgrp+timehdfibsys_yrs:t:qolgrp+utervol:t:qolgrp+demhisp_new:t:severgrp2+private:t:severgrp2+priorproc:t:severgrp2+pelvicpain:t:severgrp2+qlactvtr:t:severgrp2+qlcerntr:t:severgrp2+qlcnsctr:t:severgrp2+qlctrltr:t:severgrp2+qlergytr:t:severgrp2+utervol:t:severgrp2+demhisp_new:t:vas70+private:t:vas70+nchildren_cat:t:vas70+bleed_sys:t:vas70+qlactvtr:t:vas70+qlcnsctr:t:vas70+qlctrltr:t:vas70+qlergytr:t:vas70+qlsexftr:t:vas70+cfhsscalehealth:t:vas70+timehdfibsys_yrs:t:vas70+utervol:t:vas70+age:t:tsdiag+race_ps:t:tsdiag+priorproc:t:tsdiag+bleed_sys:t:tsdiag+anxiety:t:tsdiag+qlactvtr:t:tsdiag+qlctrltr:t:tsdiag+qlergytr:t:tsdiag+age:t:uvgrp+race_ps:t:uvgrp+nchildren_cat:t:uvgrp+anxiety:t:uvgrp+qlactvtr:t:uvgrp+qlctrltr:t:uvgrp+qlergytr:t:uvgrp+severtr:t:uvgrp+cfhsscalehealth:t:uvgrp+timehdfibsys_yrs:t:uvgrp+age:obesity:t+race_ps:obesity:t+demhisp_new:obesity:t+private:obesity:t+qlcerntr:obesity:t+qlctrltr:obesity:t+qlsexftr:obesity:t+severtr:obesity:t+cfhsscalehealth:obesity:t+utervol:obesity:t+private:gyn_his:t+bleed_sys:gyn_his:t+pelvicpain:gyn_his:t+anxiety:gyn_his:t+qlactvtr:gyn_his:t+qlcnsctr:gyn_his:t+qlsexftr:gyn_his:t+severtr:gyn_his:t+timehdfibsys_yrs:gyn_his:t+race_ps:fintox:t+nchildren_cat:fintox:t+priorproc:fintox:t+anxiety:fintox:t+qlcerntr:fintox:t+qlergytr:fintox:t+qlsexftr:fintox:t+severtr:fintox:t+nchildren_cat:route:t+priorproc:route:t+bleed_sys:route:t+anxiety:route:t+qlactvtr:route:t+qlcerntr:route:t+qlctrltr:route:t+qlergytr:route:t+qlsexftr:route:t+cfhsscalehealth:route:t")
best.form <- as.formula("y~ age+bleed_sys+pelvicpain+anxiety+qltottr+qlcerntr+qlcnsctr+qlergytr+severtr+utervol+gyn_his+route+agegrp+t+severgrp2+tsdiag+uvgrp+race_ps:agegrp+race_ps:t+private:agegrp+priorproc:agegrp+priorproc:t+bleed_sys:agegrp+bleed_sys:t+pelvicpain:agegrp+anxiety:t+qlactvtr:agegrp+qlactvtr:t+qlcerntr:t+qlctrltr:agegrp+qlergytr:t+qlsexftr:agegrp+qlsexftr:t+severtr:agegrp+cfhsscalehealth:agegrp+timehdfibsys_yrs:agegrp+utervol:agegrp+race_ps:bleed_sys+race_ps:pelvicpain+race_ps:qlsexftr+race_ps:severtr+race_ps:timehdfibsys_yrs+age:priorproc+private:priorproc+nchildren_cat:priorproc+priorproc:pelvicpain+priorproc:anxiety+priorproc:qlcnsctr+priorproc:qlctrltr+priorproc:qlergytr+priorproc:cfhsscalehealth+private:nchildren_cat+nchildren_cat:bleed_sys+nchildren_cat:pelvicpain+nchildren_cat:qlcerntr+nchildren_cat:qlcnsctr+nchildren_cat:cfhsscalehealth+nchildren_cat:timehdfibsys_yrs+nchildren_cat:utervol+age:anxiety+private:anxiety+bleed_sys:anxiety+pelvicpain:anxiety+anxiety:qlactvtr+anxiety:qlcerntr+anxiety:qlergytr+anxiety:qlsexftr+anxiety:severtr+anxiety:timehdfibsys_yrs+anxiety:utervol+private:bleed_sys+bleed_sys:qlactvtr+bleed_sys:qlcerntr+bleed_sys:severtr+demhisp_new:pelvicpain+private:pelvicpain+pelvicpain:qlactvtr+pelvicpain:qlctrltr+pelvicpain:qlergytr+pelvicpain:utervol+age:qolgrp+t:qolgrp+demhisp_new:qolgrp+private:qolgrp+nchildren_cat:qolgrp+priorproc:qolgrp+bleed_sys:qolgrp+pelvicpain:qolgrp+anxiety:qolgrp+qlcerntr:qolgrp+qlergytr:qolgrp+qlsexftr:qolgrp+severtr:qolgrp+timehdfibsys_yrs:qolgrp+utervol:qolgrp+private:severgrp2+pelvicpain:severgrp2+qlactvtr:severgrp2+qlcerntr:severgrp2+qlcnsctr:severgrp2+qlergytr:severgrp2+cfhsscalehealth:severgrp2+age:vas70+demhisp_new:vas70+private:vas70+pelvicpain:vas70+qlactvtr:vas70+qlcerntr:vas70+qlcnsctr:vas70+qlctrltr:vas70+qlergytr:vas70+qlsexftr:vas70+timehdfibsys_yrs:vas70+utervol:vas70+t:tsdiag+demhisp_new:tsdiag+priorproc:tsdiag+bleed_sys:tsdiag+pelvicpain:tsdiag+anxiety:tsdiag+qlergytr:tsdiag+age:uvgrp+race_ps:uvgrp+demhisp_new:uvgrp+private:uvgrp+nchildren_cat:uvgrp+qlactvtr:uvgrp+qlctrltr:uvgrp+qlergytr:uvgrp+qlsexftr:uvgrp+timehdfibsys_yrs:uvgrp+utervol:uvgrp+age:obesity+demhisp_new:obesity+private:obesity+qlactvtr:obesity+qlcerntr:obesity+qlctrltr:obesity+qlsexftr:obesity+severtr:obesity+utervol:obesity+age:gyn_his+gyn_his:t+demhisp_new:gyn_his+private:gyn_his+bleed_sys:gyn_his+anxiety:gyn_his+qlcnsctr:gyn_his+severtr:gyn_his+timehdfibsys_yrs:gyn_his+age:fintox+race_ps:fintox+demhisp_new:fintox+private:fintox+nchildren_cat:fintox+priorproc:fintox+anxiety:fintox+qlergytr:fintox+qlsexftr:fintox+utervol:fintox+age:route+demhisp_new:route+priorproc:route+bleed_sys:route+pelvicpain:route+qlcnsctr:route+qlergytr:route+cfhsscalehealth:route+timehdfibsys_yrs:route+utervol:route+age:agegrp:t+private:agegrp:t+priorproc:agegrp:t+bleed_sys:agegrp:t+pelvicpain:agegrp:t+qlactvtr:agegrp:t+qlcnsctr:agegrp:t+severtr:agegrp:t+timehdfibsys_yrs:agegrp:t+utervol:agegrp:t+race_ps:bleed_sys:t+race_ps:pelvicpain:t+race_ps:qlcnsctr:t+race_ps:severtr:t+race_ps:cfhsscalehealth:t+race_ps:timehdfibsys_yrs:t+age:priorproc:t+nchildren_cat:priorproc:t+priorproc:pelvicpain:t+priorproc:qlactvtr:t+priorproc:qlcnsctr:t+priorproc:qlctrltr:t+priorproc:qlergytr:t+priorproc:cfhsscalehealth:t+priorproc:timehdfibsys_yrs:t+private:nchildren_cat:t+nchildren_cat:bleed_sys:t+nchildren_cat:pelvicpain:t+nchildren_cat:qlcerntr:t+nchildren_cat:qlcnsctr:t+nchildren_cat:qlergytr:t+nchildren_cat:cfhsscalehealth:t+nchildren_cat:timehdfibsys_yrs:t+private:anxiety:t+bleed_sys:anxiety:t+pelvicpain:anxiety:t+anxiety:qlactvtr:t+anxiety:qlctrltr:t+anxiety:qlergytr:t+anxiety:qlsexftr:t+anxiety:severtr:t+anxiety:cfhsscalehealth:t+anxiety:timehdfibsys_yrs:t+anxiety:utervol:t+demhisp_new:bleed_sys:t+private:bleed_sys:t+bleed_sys:qlactvtr:t+bleed_sys:qlcerntr:t+bleed_sys:severtr:t+pelvicpain:qlactvtr:t+pelvicpain:qlcerntr:t+pelvicpain:qlcnsctr:t+pelvicpain:qlergytr:t+pelvicpain:utervol:t+age:t:qolgrp+demhisp_new:t:qolgrp+private:t:qolgrp+nchildren_cat:t:qolgrp+pelvicpain:t:qolgrp+anxiety:t:qolgrp+qlcerntr:t:qolgrp+qlctrltr:t:qolgrp+qlergytr:t:qolgrp+qlsexftr:t:qolgrp+cfhsscalehealth:t:qolgrp+timehdfibsys_yrs:t:qolgrp+utervol:t:qolgrp+demhisp_new:t:severgrp2+private:t:severgrp2+priorproc:t:severgrp2+pelvicpain:t:severgrp2+qlactvtr:t:severgrp2+qlcerntr:t:severgrp2+qlcnsctr:t:severgrp2+qlctrltr:t:severgrp2+qlergytr:t:severgrp2+utervol:t:severgrp2+demhisp_new:t:vas70+private:t:vas70+nchildren_cat:t:vas70+bleed_sys:t:vas70+qlactvtr:t:vas70+qlcnsctr:t:vas70+qlctrltr:t:vas70+qlergytr:t:vas70+qlsexftr:t:vas70+cfhsscalehealth:t:vas70+timehdfibsys_yrs:t:vas70+utervol:t:vas70+age:t:tsdiag+race_ps:t:tsdiag+priorproc:t:tsdiag+bleed_sys:t:tsdiag+anxiety:t:tsdiag+qlactvtr:t:tsdiag+qlctrltr:t:tsdiag+qlergytr:t:tsdiag+age:t:uvgrp+race_ps:t:uvgrp+nchildren_cat:t:uvgrp+anxiety:t:uvgrp+qlactvtr:t:uvgrp+qlctrltr:t:uvgrp+qlergytr:t:uvgrp+severtr:t:uvgrp+cfhsscalehealth:t:uvgrp+timehdfibsys_yrs:t:uvgrp+age:obesity:t+race_ps:obesity:t+demhisp_new:obesity:t+private:obesity:t+qlcerntr:obesity:t+qlctrltr:obesity:t+qlsexftr:obesity:t+severtr:obesity:t+cfhsscalehealth:obesity:t+utervol:obesity:t+private:gyn_his:t+bleed_sys:gyn_his:t+pelvicpain:gyn_his:t+anxiety:gyn_his:t+qlactvtr:gyn_his:t+qlcnsctr:gyn_his:t+qlsexftr:gyn_his:t+severtr:gyn_his:t+timehdfibsys_yrs:gyn_his:t+race_ps:fintox:t+nchildren_cat:fintox:t+priorproc:fintox:t+anxiety:fintox:t+qlcerntr:fintox:t+qlergytr:fintox:t+qlsexftr:fintox:t+severtr:fintox:t+nchildren_cat:route:t+priorproc:route:t+bleed_sys:route:t+anxiety:route:t+qlactvtr:route:t+qlcerntr:route:t+qlctrltr:route:t+qlergytr:route:t+qlsexftr:route:t+cfhsscalehealth:route:t")
best.var
best.form <- paste("y~", paste(best.var, collapse = "+"))
best.form
best.form <-"y~ age+bleed_sys+pelvicpain+anxiety+qltottr+qlcerntr+qlcnsctr+qlergytr+
severtr+utervol+gyn_his+route+agegrp+t+severgrp2+tsdiag+uvgrp+
race_ps:agegrp+race_ps:t+private:agegrp+priorproc:agegrp+priorproc:t+
bleed_sys:agegrp+bleed_sys:t+pelvicpain:agegrp+anxiety:t+qlactvtr:agegrp+
qlactvtr:t+qlcerntr:t+qlctrltr:agegrp+qlergytr:t+qlsexftr:agegrp+qlsexftr:t+
severtr:agegrp+cfhsscalehealth:agegrp+timehdfibsys_yrs:agegrp+utervol:agegrp+
race_ps:bleed_sys+race_ps:pelvicpain+race_ps:qlsexftr+race_ps:severtr+
race_ps:timehdfibsys_yrs+age:priorproc+private:priorproc+nchildren_cat:priorproc+
priorproc:pelvicpain+priorproc:anxiety+priorproc:qlcnsctr+priorproc:qlctrltr+
priorproc:qlergytr+priorproc:cfhsscalehealth+private:nchildren_cat+
nchildren_cat:bleed_sys+nchildren_cat:pelvicpain+nchildren_cat:qlcerntr+
nchildren_cat:qlcnsctr+nchildren_cat:cfhsscalehealth+nchildren_cat:timehdfibsys_yrs+
nchildren_cat:utervol+age:anxiety+private:anxiety+bleed_sys:anxiety+pelvicpain:anxiety+
anxiety:qlactvtr+anxiety:qlcerntr+anxiety:qlergytr+anxiety:qlsexftr+anxiety:severtr+
anxiety:timehdfibsys_yrs+anxiety:utervol+private:bleed_sys+bleed_sys:qlactvtr+
bleed_sys:qlcerntr+bleed_sys:severtr+demhisp_new:pelvicpain+private:pelvicpain+
pelvicpain:qlactvtr+pelvicpain:qlctrltr+pelvicpain:qlergytr+pelvicpain:utervol+age:qolgrp+
t:qolgrp+demhisp_new:qolgrp+private:qolgrp+nchildren_cat:qolgrp+priorproc:qolgrp+
bleed_sys:qolgrp+pelvicpain:qolgrp+anxiety:qolgrp+qlcerntr:qolgrp+qlergytr:qolgrp+
qlsexftr:qolgrp+severtr:qolgrp+timehdfibsys_yrs:qolgrp+utervol:qolgrp+private:severgrp2+
pelvicpain:severgrp2+qlactvtr:severgrp2+qlcerntr:severgrp2+qlcnsctr:severgrp2+
qlergytr:severgrp2+cfhsscalehealth:severgrp2+age:vas70+demhisp_new:vas70+private:vas70+
pelvicpain:vas70+qlactvtr:vas70+qlcerntr:vas70+qlcnsctr:vas70+qlctrltr:vas70+qlergytr:vas70+
qlsexftr:vas70+timehdfibsys_yrs:vas70+utervol:vas70+t:tsdiag+demhisp_new:tsdiag+priorproc:tsdiag+
bleed_sys:tsdiag+pelvicpain:tsdiag+anxiety:tsdiag+qlergytr:tsdiag+age:uvgrp+race_ps:uvgrp+
demhisp_new:uvgrp+private:uvgrp+nchildren_cat:uvgrp+qlactvtr:uvgrp+qlctrltr:uvgrp+qlergytr:uvgrp+
qlsexftr:uvgrp+timehdfibsys_yrs:uvgrp+utervol:uvgrp+age:obesity+demhisp_new:obesity+
private:obesity+qlactvtr:obesity+qlcerntr:obesity+qlctrltr:obesity+qlsexftr:obesity+
severtr:obesity+utervol:obesity+age:gyn_his+gyn_his:t+demhisp_new:gyn_his+private:gyn_his+
bleed_sys:gyn_his+anxiety:gyn_his+qlcnsctr:gyn_his+severtr:gyn_his+timehdfibsys_yrs:gyn_his+
age:fintox+race_ps:fintox+demhisp_new:fintox+private:fintox+nchildren_cat:fintox+priorproc:fintox+
anxiety:fintox+qlergytr:fintox+qlsexftr:fintox+utervol:fintox+age:route+demhisp_new:route+
priorproc:route+bleed_sys:route+pelvicpain:route+qlcnsctr:route+qlergytr:route+cfhsscalehealth:route+
timehdfibsys_yrs:route+utervol:route+age:agegrp:t+private:agegrp:t+priorproc:agegrp:t+
bleed_sys:agegrp:t+pelvicpain:agegrp:t+qlactvtr:agegrp:t+qlcnsctr:agegrp:t+severtr:agegrp:t+
timehdfibsys_yrs:agegrp:t+utervol:agegrp:t+race_ps:bleed_sys:t+race_ps:pelvicpain:t+race_ps:qlcnsctr:t+
race_ps:severtr:t+race_ps:cfhsscalehealth:t+race_ps:timehdfibsys_yrs:t+age:priorproc:t+
nchildren_cat:priorproc:t+priorproc:pelvicpain:t+priorproc:qlactvtr:t+priorproc:qlcnsctr:t+
priorproc:qlctrltr:t+priorproc:qlergytr:t+priorproc:cfhsscalehealth:t+priorproc:timehdfibsys_yrs:t+
private:nchildren_cat:t+nchildren_cat:bleed_sys:t+nchildren_cat:pelvicpain:t+nchildren_cat:qlcerntr:t+
nchildren_cat:qlcnsctr:t+nchildren_cat:qlergytr:t+nchildren_cat:cfhsscalehealth:t+
nchildren_cat:timehdfibsys_yrs:t+private:anxiety:t+bleed_sys:anxiety:t+pelvicpain:anxiety:t+
anxiety:qlactvtr:t+anxiety:qlctrltr:t+anxiety:qlergytr:t+anxiety:qlsexftr:t+anxiety:severtr:t+
anxiety:cfhsscalehealth:t+anxiety:timehdfibsys_yrs:t+anxiety:utervol:t+demhisp_new:bleed_sys:t+
private:bleed_sys:t+bleed_sys:qlactvtr:t+bleed_sys:qlcerntr:t+bleed_sys:severtr:t+pelvicpain:qlactvtr:t+
pelvicpain:qlcerntr:t+pelvicpain:qlcnsctr:t+pelvicpain:qlergytr:t+pelvicpain:utervol:t+age:t:qolgrp+
demhisp_new:t:qolgrp+private:t:qolgrp+nchildren_cat:t:qolgrp+pelvicpain:t:qolgrp+anxiety:t:qolgrp+
qlcerntr:t:qolgrp+qlctrltr:t:qolgrp+qlergytr:t:qolgrp+qlsexftr:t:qolgrp+cfhsscalehealth:t:qolgrp+
timehdfibsys_yrs:t:qolgrp+utervol:t:qolgrp+demhisp_new:t:severgrp2+private:t:severgrp2+priorproc:t:severgrp2+
pelvicpain:t:severgrp2+qlactvtr:t:severgrp2+qlcerntr:t:severgrp2+qlcnsctr:t:severgrp2+qlctrltr:t:severgrp2+qlergytr:t:severgrp2+utervol:t:severgrp2+demhisp_new:t:vas70+private:t:vas70+nchildren_cat:t:vas70+bleed_sys:t:vas70+qlactvtr:t:vas70+qlcnsctr:t:vas70+qlctrltr:t:vas70+qlergytr:t:vas70+qlsexftr:t:vas70+cfhsscalehealth:t:vas70+timehdfibsys_yrs:t:vas70+utervol:t:vas70+age:t:tsdiag+race_ps:t:tsdiag+priorproc:t:tsdiag+bleed_sys:t:tsdiag+anxiety:t:tsdiag+qlactvtr:t:tsdiag+qlctrltr:t:tsdiag+qlergytr:t:tsdiag+age:t:uvgrp+race_ps:t:uvgrp+nchildren_cat:t:uvgrp+anxiety:t:uvgrp+qlactvtr:t:uvgrp+qlctrltr:t:uvgrp+qlergytr:t:uvgrp+severtr:t:uvgrp+cfhsscalehealth:t:uvgrp+timehdfibsys_yrs:t:uvgrp+age:obesity:t+race_ps:obesity:t+demhisp_new:obesity:t+private:obesity:t+qlcerntr:obesity:t+qlctrltr:obesity:t+qlsexftr:obesity:t+severtr:obesity:t+cfhsscalehealth:obesity:t+utervol:obesity:t+private:gyn_his:t+bleed_sys:gyn_his:t+pelvicpain:gyn_his:t+anxiety:gyn_his:t+qlactvtr:gyn_his:t+qlcnsctr:gyn_his:t+qlsexftr:gyn_his:t+severtr:gyn_his:t+timehdfibsys_yrs:gyn_his:t+race_ps:fintox:t+nchildren_cat:fintox:t+priorproc:fintox:t+anxiety:fintox:t+qlcerntr:fintox:t+qlergytr:fintox:t+qlsexftr:fintox:t+severtr:fintox:t+nchildren_cat:route:t+priorproc:route:t+bleed_sys:route:t+anxiety:route:t+qlactvtr:route:t+qlcerntr:route:t+qlctrltr:route:t+qlergytr:route:t+qlsexftr:route:t+cfhsscalehealth:route:t"
best.model <- lm(best.form, data = data)
best.model
library(PSweight.sga)
data(psdata_sga)
# pre-specify the confounder names: X1-X20
xname <- paste0('X',1:20)
# pre-specify subgroups of interest by column names
subgroup<-paste0('X',c(1,2,3, 19,20))
p1<-PSweight_sga(ps.formula=ps.form_m,subgroup=subgroup,yname="Y",data=psdata_sga,R=50,weight="overlap")
ps.form_m <- paste("Treatment~",paste0("X",1:20,collapse = "+"))
p1<-PSweight_sga(ps.formula=ps.form_m,subgroup=subgroup,yname="Y",data=psdata_sga,R=50,weight="overlap")
tmp <-do.call(rbind, summary(p1)$estimates)
rownames(tmp) <- rownames(p1$muhat)
tmp
x=tmp
p1$method
Subgroups <-rownames(x)
Metd <- x$method
tab <- as.data.frame(cbind(x, method= Metd, subgroup= Subgroups ))
obj=p1
Metd <- obj$method
tab <- as.data.frame(cbind(x, method= Metd, subgroup= Subgroups ))
tab
fdata <- as.data.frame(cbind(x, method= Metd, subgroup= Subgroups ))
fplot =ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Metd,
title = "Subgroup causal effect estimates and 95% CIs",
xlab = xlab)+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
splot <- fplot+ theme(panel.border = element_rect(linetype = "solid", fill = NA))
print(splot)
logodds=FALSE
xlab=NULL
fplot =ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Metd,
title = "Subgroup causal effect estimates and 95% CIs",
xlab = xlab)+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
splot <- fplot+ theme(panel.border = element_rect(linetype = "solid", fill = NA))
print(splot)
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Metd,
title = "Subgroup causal effect estimates and 95% CIs",
xlab = xlab)
x
x <-as.data.frame(obj$estimates)
x<-as.data.frame(tmp)
Std <- x$Std.Error
x
colnames(fdata)[2]
colnames(fdata)[2]<-"Std"
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std,
logodds = logodds,
colour = Metd,
title = "Subgroup causal effect estimates and 95% CIs",
xlab = xlab)
rlang::last_error()
x
x <-as.data.frame(obj$estimates)
fdata <- as.data.frame(cbind(x, method= Metd, subgroup= Subgroups ))
fdata <- cbind(x, method= Metd, subgroup= Subgroups )
Subgroups
x <-as.data.frame(obj$estimates)
x<-as.data.frame(tmp)
cbind(x, method= Metd, subgroup= Subgroups )
fdata <- cbind(x, method= Metd, subgroup= Subgroups )
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Metd,
title = "Subgroup causal effect estimates and 95% CIs",
xlab = xlab)
Method <- obj$method
Std <- x$Std.Error
fdata <- cbind(x, method= Method, subgroup= Subgroups )
# rmst_full <-df_linear_rmst %>%  dplyr::arrange(subgroup)
fplot =ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effect estimates and 95% CIs",
xlab = xlab)+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
splot <- fplot+ theme(panel.border = element_rect(linetype = "solid", fill = NA))
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab)
library(ggplot2)
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab)+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
splot <- fplot+ theme(panel.border = element_rect(linetype = "solid", fill = NA))
fplot =ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab)+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
splot <- fplot+ theme(panel.border = element_rect(linetype = "solid", fill = NA))
splot
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = TRUE,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab)
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab,
ylab="Subgroups")+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12))
p2 <- PSweight_sga(xname=xname, subgroup=subgroup, yname="Y",zname="Treatment",data=psdata_sga,R=50, method='LASSO',weight="overlap")
obj=list(p1,p2)
getwd()
setwd("C:/Users/sy89/Documents/PSweight.sga")
library(devtools)
load_all()
summary(p1)
load_all()
summary(p1)
load_all()
summary(p1)
summary(p1, het=T)
load_all()
summary(p1, het=T)
p2 <- PSweight_sga(xname=xname, subgroup=subgroup, yname="Y",zname="Treatment",data=psdata_sga,R=50, method='LASSO',weight="overlap")
summary(p2)
source('~/PSweight.sga/R/summary_PSweight_sga.R')
p1<-PSweight_sga(ps.formula=ps.form_m,subgroup=subgroup,yname="Y",data=psdata_sga,R=50,weight="overlap")
s1 <- summary(p1)
s2 <- summary(p2)
obj <- list(s1,s2)
do.call(obj$estimates, rbind)
do.call( rbind, obj$estimates)
do.call( rbind, obj)
simplify2array(lapply(obj, function(x) obj$estimates))
lapply(obj, function(x) obj$estimates)
simplify2array(lapply(obj, function(x) obj))
simplify2array(obj)
simplify2array(obj)$estimates
obj
lapply(obj, function (x) x[c('estimates')])
test <- lapply(obj, function (x) x[c('estimates')])
do.call(rbind, test)
simplify2array(test)
ar <-simplify2array(test)
do.call(rbind, ar)
x= do.call(rbind, ar)
x
ar$estimates
ary <-simplify2array(lapply(obj, function (x) x[c('estimates')]))
ary$estimates
x
lapply(obj, function (x) x[c('method')])
c(lapply(obj, function (x) x[c('method')]))
Method <- simplify2array(lapply(obj, function (x) x[c('method')]))
Method
unlist(Method)
Subgroups <-rownames(ary$estimates)
Subgroups
nsub <- length(Subgroups)
nsub
Method <- simplify2array(lapply(obj, function (x) x[c('method')]))
Method
rep (unlist(Method),each = nsub)
ary <-simplify2array(lapply(obj, function (x) x[c('estimates')]))
x <- do.call(rbind, ary)
Subgroups <-rownames(ary$estimates)
nsub <- length(Subgroups)
Method <- simplify2array(lapply(obj, function (x) x[c('method')]))
fdata <- cbind(x, method= rep (unlist(Method),each = nsub), subgroup= Subgroups )
fdata
x <-as.data.frame(do.call(rbind, ary))
Subgroups <-rownames(ary$estimates)
nsub <- length(Subgroups)
Method <- simplify2array(lapply(obj, function (x) x[c('method')]))
fdata <- cbind(x, method= rep (unlist(Method),each = nsub), subgroup= Subgroups )
fdata
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab,
ylab="Subgroups")+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
fdata
fdata <- cbind(x, Method= rep (unlist(method),each = nsub), subgroup= Subgroups )
method <- simplify2array(lapply(obj, function (x) x[c('method')]))
fdata <- cbind(x, Method= rep (unlist(method),each = nsub), subgroup= Subgroups )
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab,
ylab="Subgroups")+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
plot.PSweight_sga <- function(obj=list(), logodds=FALSE, xlab=NULL){
VarName  <- Subgroups <- lcolor <- c()
ary <-simplify2array(lapply(obj, function (x) x[c('estimates')]))
x <-as.data.frame(do.call(rbind, ary))
Subgroups <-rownames(ary$estimates)
nsub <- length(Subgroups)
method <- simplify2array(lapply(obj, function (x) x[c('method')]))
fdata <- cbind(x, Method= rep (unlist(method),each = nsub), subgroup= Subgroups )
# rmst_full <-df_linear_rmst %>%  dplyr::arrange(subgroup)
fplot =ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab,
ylab="Subgroups")+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #change legend text font size
#splot <- fplot+ theme(panel.border = element_rect(linetype = "solid", fill = NA))
print(fplot)
}
plot.PSweight_sga(obj )
method=NULL
is.null(method)
load_all()
library(devtools)
load_all()
document()
load_all()
check()
document()
getwd()
document()
check()
check()
check()
check()
check()
check()
check()
check()
check()
data(psdata_sga)
xname <- paste0('X',1:20)
# pre-specify subgroups of interest by column names
subgroup<-paste0('X',c(1,2,3, 19,20))
p1<-PSweight_sga(ps.formula=ps.form_m,subgroup=subgroup,yname="Y",data=psdata_sga,R=50,weight="overlap")
ps.form_m <- paste("Treatment~",paste0("X",1:20,collapse = "+"))
p1<-PSweight_sga(ps.formula=ps.form_m,subgroup=subgroup,yname="Y",data=psdata_sga,R=50,weight="overlap")
s1 <- summary(p1)
summary(p1, het=T)
plot(s1)
plot(list(s1))
p2 <- PSweight_sga(xname=xname, subgroup=subgroup, yname="Y",zname="Treatment",data=psdata_sga,R=50, method='LASSO',weight="overlap")
s2 <- summary(p2)
plot(list(s1,s2))
x=list(s1, s2)
plot(x)
check()
plot(x=list(s1,s2))
x
plot(x)
x
ary <-simplify2array(lapply(x, function (x) x[c('estimates')]))
ary
obj=list()
length(obj)
is.null(obj)
str(obj)
check()
plot(s1)
plot(obj=s1)
plot.PSweight_sga(s1)
plot.PSweight_sga(list(s1,s2))
plot.PSweight_sga(obj=list(s1,s2))
obj=list(s1,s2)
logodds=FALSE
xlab=NULL
legend_label=NULL
Std.Error  <- subgroup <- Estimate <- Method <-c()
# if (length(obj)==0) {
#   x <- x$estimates
#   Subgroups <-rownames(x)}else{
#   ary <-simplify2array(lapply(obj, function (obj) obj[c('estimates')]))
#   x <-as.data.frame(do.call(rbind, ary))
#   Subgroups <- rownames(ary$estimates)
# }
obj=list(obj)
ary <-simplify2array(lapply(obj, function (obj) obj[c('estimates')]))
x <-as.data.frame(do.call(rbind, ary))
Subgroups <- rownames(ary$estimates)
nsub <- length(Subgroups)
if(is.null(legend_label)){method <-unlist(simplify2array(lapply(obj, function (obj) obj[c('method')]))) }else{
method <- legend_label
}
fdata <- cbind(x, Method= rep (method,each = nsub), subgroup= Subgroups )
fdata
x
check()
plot.PSweight_sga(list(s1,s2))
obj=list(s1,s2)
ary <-simplify2array(lapply(obj, function (obj) obj[c('estimates')]))
x <-as.data.frame(do.call(rbind, ary))
Subgroups <- rownames(ary$estimates)
nsub <- length(Subgroups)
if(is.null(legend_label)){method <-unlist(simplify2array(lapply(obj, function (obj) obj[c('method')]))) }else{
method <- legend_label
}
fdata <- cbind(x, Method= rep (method,each = nsub), subgroup= Subgroups )
ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab,
ylab="Subgroups")+
ggplot2::theme(legend.key.size = unit(10, 'cm'), #change legend key size
legend.key.height = unit(1, 'cm'), #change legend key height
legend.key.width = unit(1, 'cm'), #change legend key width
legend.title = element_text(size=14), #change legend title font size
legend.text = element_text(size=12)) #
plot.PSweight_sga(list(s1,s2))
plot.PSweight_sga(obj=list(s1,s2))
load_all()
load_all()
plot.PSweight_sga(list(s1,s2))
plot(list(s1,s2))
fplot =ggforestplot::forestplot(
df = fdata,
name=subgroup,
estimate = Estimate,
se=Std.Error,
logodds = logodds,
colour = Method,
title = "Subgroup causal effects and 95% CIs",
xlab = xlab,
ylab="Subgroups")
fplot
fplot+ ggforestplot::geom_effect(ggplot2::aes(xmin = .data$.xmin, xmax = .data$.xmax,
colour = .data$colour, filled = .data$.filled),
position = ggstance::position_dodgev(height = 0.5),
fatten=10)
fplot+ ggforestplot::geom_effect(ggplot2::aes(xmin = .data$.xmin, xmax = .data$.xmax),
position = ggstance::position_dodgev(height = 0.5),
fatten=10)
check()
document()
check()
ForestPlot(s1)
ForestPlot(list(s1,s2))
ForestPlot(list(s1))
ForestPlot(list(s1), xlab="month")
